---
import BlogPost from "@/layouts/BlogPost.astro";
import BaseHead from "@/components/BaseHead.astro";
import "@/styles/global.css";
import { type CollectionEntry, getCollection, render } from "astro:content";

const posts = (await getCollection("blog")).sort(
  (a, b) => b.data.date.valueOf() - a.data.date.valueOf(),
);

const links = posts.map((post) => `${import.meta.env.BASE_URL}${post.id}`);
// const links = posts.map((post) => `/${post.id}`);
---

<!doctype html>
<html lang="en">
  <head>
    <base href={import.meta.env.BASE_URL} />
    <script is:inline src="./light-mode.js"></script>
  </head>
  <body>
    <span style="display: none" id="links">{JSON.stringify(links)}</span>
    <script lang="javascript">
      const urls = JSON.parse(document.getElementById("links").textContent);
      var randURL = Math.floor(Math.random() * urls.length);
      window.open(urls[randURL], "_self");
    </script>
    <span>Redirecting...</span>
  </body>
</html>
