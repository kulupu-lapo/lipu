---
import FoundPost from "@/components/FoundPost.astro";
import SearchPage from "@/layouts/SearchPage.astro";
import { escape, getPostsByTag, tags, unescape } from "@/utils/content";

export async function getStaticPaths() {
  return tags.map((tag) => ({
    params: { tag: escape(tag) },
    props: { posts: getPostsByTag(tag) },
  }));
}

const { tag } = Astro.params;
const { posts } = Astro.props;
---

<SearchPage title={unescape(tag)}>
  <h2>Posts tagged with {unescape(tag)} ({posts.length})</h2>
  <ul>
    {posts.map((post) => <FoundPost {...post} />)}
  </ul>
</SearchPage>
